<div id="message-container" class="message-container" #container [class.readonly]="isReadOnly">

  <div class="mention-dropdown" *ngIf="showMentions && activeMentionType === 'user'" [ngStyle]="{
      left: mentionPosition.left + 'px',
      bottom: mentionPosition.bottom + 'px'
    }">
    <div class="mention-item" *ngFor="let user of filteredUsers; let i = index"
      [class.selected]="i === selectedMentionIndex" (click)="onSelectUser(user)">
      <span class="mention-avatar">
        <img [src]="(getAvatarSrc(user.avatarId) || 'avatar_default')" [alt]="getListLabel(user)" />
        <img [src]="userService.getOnlineStatusIcon(user)" class="status-dot">
      </span>
      <span class="mention-name">
        {{ getListLabel(user) }}
      </span>
    </div>
  </div>
 
  <div class="mention-dropdown" *ngIf="showMentions && activeMentionType === 'channel'" [ngStyle]="{
      left: mentionPosition.left + 'px',
      bottom: mentionPosition.bottom + 'px'
    }">
    <div class="mention-item" *ngFor="let ch of filteredChannels; let i = index"
      [class.selected]="i === selectedMentionIndex" (click)="onSelectChannel(ch)">
      <span class="mention-hash">#</span>
      <span class="mention-name">{{ ch.name }}</span>
    </div>

  </div>

  <div class="emoji-picker" *ngIf="showEmojiPicker">
    <button class="emoji-btn" *ngFor="let emoji of emojiReactions" (click)="onEmojiSelect(emoji.icon)">
      {{ emoji.icon }}
    </button>
  </div>


  <textarea #messageInput
    [placeholder]="isReadOnly ? 'Du bist kein Mitglied dieses Channels' : (placeholderText ?? 'Antworten...')"
    [disabled]="isReadOnly" (keyup)="onKeyup($event)" (keydown)="onKeydown($event)">
</textarea>

  <div id="message-actions">
    <div>
      <img src="/assets/icons/global/smile1.svg" alt="Emoji" class="form-input-icon icon-smile"
        (click)="onEmojiButtonClick()" />

      <img src="/assets/icons/global/at1.svg" alt="Mention" class="form-input-icon icon-at"
        (click)="onAtButtonClick()" />
    </div>

    <img src="/assets/icons/global/send1.svg" alt="Send" class="icon-send" [class.disabled]="isReadOnly"
      (click)="onSend()" />
  </div>
</div>