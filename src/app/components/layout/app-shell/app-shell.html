<app-topbar [isNewMessageMode]="isNewMessageMode()" [showMobileBack]="isMobile() && activeMobileView() !== 'sidebar'"
  (back)="backOneLevel()">
</app-topbar>


<section class="shell">

  @if (!isMobile() || activeMobileView() === 'sidebar') {
  <app-workspace-sidebar [isMobile]="isMobile()" [currentUserUid]="currentUserUid" (newMessage)="openNewMessage()"
    (mobileViewChange)="activeMobileView.set($event)"></app-workspace-sidebar>
  }

  @if (!isMobile() || activeMobileView() === 'chat' || activeMobileView() === 'new-message') {
  <app-view [currentUserUid]="currentUserUid" (openThread)="onOpenThread()"></app-view>
  }


  @if (!isMobile() || activeMobileView() === 'thread') {
  <!-- ========== DYNAMIC CLASS BINDING ========== -->
  <app-thread-menu 
    [currentUserUid]="currentUserUid"
    [class.thread-open]="threadService.isOpen()">
  </app-thread-menu>
  <!-- ========== DYNAMIC CLASS BINDING END ========== -->
  }

</section>

@if (isMobile() && activeMobileView() === 'sidebar') {
<button class="resp-fab" matFab (click)="openNewMessage()">
  <img src="/assets/icons/global/edit_square_white.svg" alt="">
</button>
}